(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{103:function(e,a,t){"use strict";t.r(a);var n=t(0),c=t.n(n),r=t(13),o=t.n(r),s=(t(76),t(18)),i=t(21),d=t(3),b=t(147),l=t(151),j=t(148),u=t(46),m=t(146),O=t(142),p=t(143),x=t(145),h=t(144),f=t(150),g=t(139),w=t(104),I=t(149),v=t(45),y=t(9),k=t(6),S=t(10),U=t(140),N=t(63),L=t.n(N),D=t(64),C=t.n(D),V=t(61),E=t.n(V),F=t(62),T=t.n(F),R=t(60),H=t.n(R),z=t(59),B=t.n(z),G=t(137),A=t(141),J=t(56),M=t.n(J),P=t(36),W=t(57),q=t(138),K=Object(q.a)((function(e){return{root:{height:"100%"},toolbar:{paddingRight:24},toolbarIcon:Object(s.a)({display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px"},e.mixins.toolbar),appBar:{zIndex:e.zIndex.drawer+1},title:{flexGrow:1},appBarSpacer:e.mixins.toolbar,content:{},container:{paddingLeft:0,paddingRight:0,paddingBottom:e.spacing(2)},noHeader:{paddingTop:e.spacing(5)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fabGreen:{backgroundColor:"#3fb553"},fabRed:{backgroundColor:"#c74f4f"},nested:{paddingLeft:e.spacing(5)},btnGreen:{backgroundColor:"#3fb553"},btnRed:{backgroundColor:"#c74f4f"}}})),$=(t(98),t(2));y.b.add(k.n,k.k),y.b.add(k.w,k.k),y.b.add(k.e,k.k),y.b.add(k.x,k.k),y.b.add(k.g,k.k),y.b.add(k.z,k.k),y.b.add(k.h,k.k),y.b.add(k.j,k.k),y.b.add(k.o,k.k),y.b.add(k.l,k.k),y.b.add(k.u,k.k),y.b.add(k.b,k.k),y.b.add(k.m,k.k),y.b.add(k.p,k.k),y.b.add(k.a,k.k),y.b.add(k.q,k.k),y.b.add(k.c,k.k),y.b.add(k.t,k.k),y.b.add(k.s,k.k),y.b.add(k.f,k.k),y.b.add(k.v,k.k),y.b.add(k.y),y.b.add(k.r),y.b.add(k.i),y.b.add(k.d);var Q=c.a.memo((function(e){switch(e.img){case"temperature":return Object($.jsx)(S.a,{icon:"temperature-high"});case"humidity":return Object($.jsx)(S.a,{icon:"tint"});case"fan":return Object($.jsx)(S.a,{icon:"fan"});case"window":return Object($.jsx)(S.a,{icon:"window-maximize"});case"radiator":return Object($.jsx)(S.a,{icon:"fire"});case"hdd":return Object($.jsx)(S.a,{icon:"hdd"});case"mem":return Object($.jsx)(S.a,{icon:"memory"});case"sys":return Object($.jsx)(S.a,{icon:"laptop"});case"settings":return Object($.jsx)(S.a,{icon:"sliders-h"});case"dev":return Object($.jsx)(S.a,{icon:"bug"});case"group":return Object($.jsx)(S.a,{icon:"layer-group"});case"cpu":return Object($.jsx)(S.a,{icon:"microchip"});case"electricity":return Object($.jsx)(S.a,{icon:"bolt"});case"price":return Object($.jsx)(S.a,{icon:"money-bill-alt"});case"boiler":return Object($.jsx)(S.a,{icon:"burn"});case"shower":return Object($.jsx)(S.a,{icon:"shower"});case"plug":return Object($.jsx)(S.a,{icon:"plug"});case"clock":return Object($.jsx)(S.a,{icon:"clock"});case"timer":return Object($.jsx)(S.a,{icon:"stopwatch"});case"switch":return Object($.jsx)(S.a,{icon:"toggle-on"});case"light":return Object($.jsx)(S.a,{icon:"lightbulb"});case"network":return Object($.jsx)(S.a,{icon:"network-wired"});case"fish":return Object($.jsx)(S.a,{icon:"fish"})}return Object($.jsx)(S.a,{icon:"chart-bar"})})),X=c.a.memo((function(e){var a=c.a.useState("ON"===e.Value),t=Object(i.a)(a,2),n=t[0],r=t[1];return Object($.jsx)(f.a,{edge:"end",color:"primary",onChange:function(a){r(!n),fetch("".concat(e.baseUrl,"/item/").concat(e.ID),{method:"POST",body:n?"OFF":"ON"})},checked:"ON"===e.Value})})),Y=c.a.memo((function(e){var a=K();return Object($.jsx)(w.a,{variant:"contained",color:"primary",className:"ON"===e.Value?a.btnGreen:"",children:e.Label})})),Z=c.a.memo((function(e){return Object($.jsxs)(u.a,{children:[e.Value,e.Unit]})})),_=c.a.memo((function(e){var a=c.a.useState(parseFloat(e.Value)),t=Object(i.a)(a,2),n=t[0],r=t[1],o=function(a){fetch("".concat(e.baseUrl,"/item/").concat(e.ID),{method:"POST",body:a.toString()})};return Object($.jsxs)(g.a,{variant:"contained",color:"primary",style:{boxShadow:"none"},children:[Object($.jsx)(w.a,{className:"Shadow-button",style:{padding:"6px 8px"},"aria-label":"reduce",onClick:function(){r(n-.5),o(n-.5)},children:Object($.jsx)(B.a,{fontSize:"small"})}),Object($.jsx)(w.a,{variant:"outlined",component:"span",className:"Middle-button",style:{padding:"5px 8px",color:"#000",border:"none"},children:n.toFixed(1)}),Object($.jsx)(w.a,{className:"Shadow-button",style:{padding:"6px 8px"},"aria-label":"increase",onClick:function(){r(n+.5),o(n+.5)},children:Object($.jsx)(H.a,{fontSize:"small"})})]})})),ee=c.a.memo((function(e){return e.items?e.isOpen?Object($.jsx)(T.a,{}):Object($.jsx)(E.a,{}):Object($.jsx)("svg",{viewBox:"0 0 24 24"})})),ae=c.a.memo((function(e){var a=K();return"ON"===e.Value?Object($.jsx)(U.a,{color:"primary","aria-label":"OK",size:"small",className:a.fabGreen,children:Object($.jsx)(L.a,{})}):Object($.jsx)(U.a,{color:"primary","aria-label":"KO",size:"small",className:a.fabRed,children:Object($.jsx)(C.a,{})})})),te=c.a.memo((function(e){var a=K();switch(e.Type){case"switch":return Object($.jsx)(X,Object(s.a)({},e));case"value":return Object($.jsx)(Z,Object(s.a)({},e));case"range":return Object($.jsx)(_,Object(s.a)({},e));case"state":return Object($.jsx)(ae,Object(s.a)({},e));case"button":return Object($.jsx)(Y,Object(s.a)({},e));case"timer":var t="OFF"===e.Value?"OFF":"ON",n="OFF"!==e.Value&&"ON"!==e.Value?e.Value:"0";return Object($.jsx)(A.a,{color:"primary",badgeContent:n,max:999,children:Object($.jsx)(w.a,{variant:"contained",color:"primary",className:"ON"===e.Value?a.btnGreen:a.btnRed,children:t})});default:return Object($.jsx)(c.a.Fragment,{})}})),ne=c.a.memo((function(e){var a=c.a.useState([["date","value"],["00:00",0]]),t=Object(i.a)(a,2),r=t[0],o=t[1],s=function(){fetch("".concat(e.baseUrl,"/values/").concat(e.ID),{keepalive:!1}).then((function(e){if(!e.ok)throw new Error(e.statusText);e.json().then((function(e){e.unshift(["date","value"]),o(e)}))}))};return Object(n.useEffect)((function(){s();var e=setInterval((function(){s()}),3e4);return function(){return clearInterval(e)}}),[]),Object($.jsx)(W.a,{width:"100%",height:"250px",chartType:"AreaChart",loader:Object($.jsx)("div",{children:"Loading data"}),data:r,options:{chartArea:{width:"80%",height:"70%"},backgroundColor:"#fafafa",legend:"none"}})})),ce=c.a.memo((function(e){var a=K(),t=c.a.useState(!1),n=Object(i.a)(t,2),r=n[0],o=n[1];return Object($.jsxs)("div",{onClick:function(){o(!r)},children:[Object($.jsx)(re,{className:a.nested,ID:e.ID,Type:e.Type,Img:e.Img,Label:e.Label,Value:e.Value,Unit:e.Unit,LastUpdate:e.LastUpdate,HistoryEnabled:e.HistoryEnabled,baseUrl:e.baseUrl},e.ID),e.HistoryEnabled&&Object($.jsx)(G.a,{in:r,timeout:"auto",unmountOnExit:!0,children:Object($.jsx)(ne,{ID:e.ID,baseUrl:e.baseUrl})})]})})),re=c.a.memo((function(e){var a=c.a.useState(!1),t=Object(i.a)(a,2),n=t[0],r=t[1],o=Object($.jsxs)(c.a.Fragment,{children:[e.HistoryEnabled&&Object($.jsx)(S.a,{icon:"chart-area",style:{marginLeft:"-12px",marginRight:"3px"}}),e.LastUpdate&&Object($.jsxs)(c.a.Fragment,{children:["Updated: ",e.LastUpdate]})]});return Object($.jsxs)(c.a.Fragment,{children:[Object($.jsxs)(O.a,{className:e.className,onClick:function(){r(!n)},children:[Object($.jsx)(p.a,{children:Object($.jsxs)(c.a.Fragment,{children:[Object($.jsx)(ee,{items:e.SubItems,isOpen:n}),Object($.jsx)(Q,{img:e.Img})]})}),Object($.jsx)(h.a,{primary:e.Label,secondary:o}),Object($.jsx)(x.a,{children:Object($.jsx)(te,Object(s.a)({},e))})]}),e.SubItems&&Object($.jsx)(G.a,{in:n,timeout:"auto",unmountOnExit:!0,children:Object($.jsx)(m.a,{component:"div",disablePadding:!0,children:e.SubItems.map((function(a){return Object($.jsx)(ce,{ID:a.ID,Type:a.Type,Img:a.Img,Label:a.Label,Value:a.Value,Unit:a.Unit,LastUpdate:a.LastUpdate,HistoryEnabled:a.HistoryEnabled,baseUrl:e.baseUrl})}))})})]})})),oe=c.a.memo((function(e){var a=K(),t=Object(n.useState)({Rows:Array()}),r=Object(i.a)(t,2),o=r[0],s=r[1],O=Object(n.useState)(0),p=Object(i.a)(O,2),x=p[0],h=p[1],f=Object(n.useRef)(null),g=P.parse(window.location.search).address,w=P.parse(window.location.search).username,v=P.parse(window.location.search).password,y=v?"".concat(w,":").concat(v,"@"):"",k="http://".concat(g||window.location.host),S=k.replace("http://","ws://".concat(y)),U="native"===P.parse(window.location.search).mode,N=Object(n.useCallback)((function(a,t){e.enqueueSnackbar(a,{variant:t,autoHideDuration:1e3,anchorOrigin:{vertical:"bottom",horizontal:"right"}})}),[e]),L=Object(n.useCallback)((function(){var e=new Headers;if(v){var a="".concat(w,":").concat(v);e.set("Authorization","Basic "+btoa(a))}fetch("".concat(k,"/?type=json"),{headers:e,keepalive:!1}).then((function(e){return e.json().then((function(e){N("Data retrieve succesfully","info"),s(e)}))})).catch((function(e){N("Unable to load or parse topology data ".concat(e),"error"),setTimeout(L,2e3)}))}),[N,k,v,w]);return Object(n.useEffect)((function(){L()}),[e,L,f]),Object($.jsxs)("div",{className:a.root,children:[Object($.jsx)(M.a,{ref:f,url:"".concat(S,"/ws"),onOpen:function(){if(N("Connected to events","success"),!x){var e=window.setInterval((function(){f.current.sendMessage(JSON.stringify("keepalive"))}),2e3);h(e)}},onMessage:function(e){!function(e,a){a.forEach((function(a,t){a.Item.ID!==e.ID?a.SubItems&&a.SubItems.forEach((function(t,n){if(t.ID===e.ID&&a.SubItems)return a.SubItems[n]=e,void("label"==a.Item.Type&&(a.Item.LastUpdate=e.LastUpdate))})):a.Item=e}))}(JSON.parse(e),o.Rows),s({Rows:o.Rows})},onClose:function(){N("Event connection lost","error"),window.clearInterval(x),h(0)},reconnectIntervalInMilliSeconds:5e3}),Object($.jsx)(b.a,{}),!U&&Object($.jsx)(c.a.Fragment,{children:Object($.jsx)(l.a,{position:"fixed",className:a.appBar,children:Object($.jsx)(j.a,{className:a.toolbar,variant:"dense",children:Object($.jsx)(u.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:a.title,children:"H.A.S.C."})})})}),Object($.jsx)(I.a,{className:Object(d.a)(a.container,!U&&a.noHeader),children:Object($.jsx)(m.a,{className:a.content,children:o.Rows.map((function(e){return Object($.jsx)(re,{ID:e.Item.ID,Type:e.Item.Type,Img:e.Item.Img,Label:e.Item.Label,Value:e.Item.Value,Unit:e.Item.Unit,LastUpdate:e.Item.LastUpdate,SubItems:e.SubItems,HistoryEnabled:!1,baseUrl:k},e.Item.ID)}))})})]})})),se=Object(v.b)(oe);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(Object($.jsx)(v.a,{maxSnack:1,children:Object($.jsx)(se,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},76:function(e,a,t){},98:function(e,a,t){}},[[103,1,2]]]);
//# sourceMappingURL=main.6bfc9fd0.chunk.js.map